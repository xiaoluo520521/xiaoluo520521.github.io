(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a0abed14"],{"1dde":function(e,t,n){var c=n("d039"),s=n("b622"),i=n("2d00"),o=s("species");e.exports=function(e){return i>=51||!c((function(){var t=[],n=t.constructor={};return n[o]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},"4de4":function(e,t,n){"use strict";var c=n("23e7"),s=n("b727").filter,i=n("1dde"),o=i("filter");c({target:"Array",proto:!0,forced:!o},{filter:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}})},"6c21":function(e,t,n){},"9a46":function(e,t,n){"use strict";n.r(t);var c=n("7a23"),s={style:{padding:"10px","margin-bottom":"50px"}},i=Object(c["n"])("div",{style:{"padding-bottom":"10px","border-bottom":"1px solid #ccc"}},[Object(c["q"])("在线用户"),Object(c["n"])("span",{style:{"font-size":"12px"}},"（点击聊天气泡开始聊天）")],-1),o=["onClick"],r={key:0,style:{"font-size":"12px",color:"limegreen","margin-left":"5px"}},l={style:{width:"800px",margin:"0 auto","background-color":"white","border-radius":"5px","box-shadow":"0 0 10px #ccc"}},a={style:{"text-align":"center","line-height":"50px"}},u=["innerHTML"],d={style:{height:"200px"}},b={style:{"text-align":"right","padding-right":"10px"}},p=Object(c["q"])("发送");function g(e,t,n,g,h,f){var x=Object(c["T"])("el-card"),m=Object(c["T"])("el-col"),v=Object(c["T"])("el-button"),j=Object(c["T"])("el-row");return Object(c["K"])(),Object(c["m"])("div",s,[Object(c["r"])(j,null,{default:Object(c["ib"])((function(){return[Object(c["r"])(m,{span:4},{default:Object(c["ib"])((function(){return[Object(c["r"])(x,{style:{width:"300px",height:"300px",color:"#333"}},{default:Object(c["ib"])((function(){return[i,(Object(c["K"])(!0),Object(c["m"])(c["b"],null,Object(c["R"])(h.users,(function(e){return Object(c["K"])(),Object(c["m"])("div",{style:{padding:"10px 0"},key:e.username},[Object(c["n"])("span",null,Object(c["X"])(e.username),1),Object(c["n"])("i",{class:"el-icon-chat-dot-round",style:{"margin-left":"10px","font-size":"16px",cursor:"pointer"},onClick:function(t){return h.chatUser=e.username}},null,8,o),e.username===h.chatUser?(Object(c["K"])(),Object(c["m"])("span",r,"chatting...")):Object(c["l"])("",!0)])})),128))]})),_:1})]})),_:1}),Object(c["r"])(m,{span:20},{default:Object(c["ib"])((function(){return[Object(c["n"])("div",l,[Object(c["n"])("div",a," Web聊天室（"+Object(c["X"])(h.chatUser)+"） ",1),Object(c["n"])("div",{style:{height:"350px",overflow:"auto","border-top":"1px solid #ccc"},innerHTML:h.content},null,8,u),Object(c["n"])("div",d,[Object(c["jb"])(Object(c["n"])("textarea",{"onUpdate:modelValue":t[0]||(t[0]=function(e){return h.text=e}),style:{height:"160px",width:"100%",padding:"20px",border:"none","border-top":"1px solid #ccc","border-bottom":"1px solid #ccc",outline:"none"}},null,512),[[c["eb"],h.text]]),Object(c["n"])("div",b,[Object(c["r"])(v,{type:"primary",size:"mini",onClick:f.send},{default:Object(c["ib"])((function(){return[p]})),_:1},8,["onClick"])])])])]})),_:1})]})),_:1})])}n("4de4"),n("b775");var h,f={name:"Im",data:function(){return{circleUrl:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",user:{},isCollapse:!1,users:[],chatUser:"",text:"",messages:[],content:""}},created:function(){this.init()},methods:{send:function(){if(this.chatUser)if(this.text)if("undefined"==typeof WebSocket)console.log("您的浏览器不支持WebSocket");else{console.log("您的浏览器支持WebSocket");var e={from:this.user.username,to:this.chatUser,text:this.text};h.send(JSON.stringify(e)),this.messages.push({user:this.user.username,text:this.text}),this.createContent(null,this.user.username,this.text),this.text=""}else this.$message({type:"warning",message:"请输入内容"});else this.$message({type:"warning",message:"请选择聊天对象"})},createContent:function(e,t,n){var c;t?c='<div class="el-row" style="padding: 5px 0">\n  <div class="el-col el-col-22" style="text-align: right; padding-right: 10px">\n    <div class="tip left">'+n+'</div>\n  </div>\n  <div class="el-col el-col-2">\n  <span class="el-avatar el-avatar--circle" style="height: 40px; width: 40px; line-height: 40px;">\n    <img src="https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png" style="object-fit: cover;">\n  </span>\n  </div>\n</div>':e&&(c='<div class="el-row" style="padding: 5px 0">\n  <div class="el-col el-col-2" style="text-align: right">\n  <span class="el-avatar el-avatar--circle" style="height: 40px; width: 40px; line-height: 40px;">\n    <img src="https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png" style="object-fit: cover;">\n  </span>\n  </div>\n  <div class="el-col el-col-22" style="text-align: left; padding-left: 10px">\n    <div class="tip right">'+n+"</div>\n  </div>\n</div>"),console.log(c),this.content+=c},init:function(){this.user=sessionStorage.getItem("user")?JSON.parse(sessionStorage.getItem("user")):{};var e=this.user.username,t=this;if("undefined"==typeof WebSocket)console.log("您的浏览器不支持WebSocket");else{console.log("您的浏览器支持WebSocket");var n="ws://localhost:9090/imserver/"+e;null!=h&&(h.close(),h=null),h=new WebSocket(n),h.onopen=function(){console.log("websocket已打开")},h.onmessage=function(n){console.log("收到数据===="+n.data);var c=JSON.parse(n.data);c.users?t.users=c.users.filter((function(t){return t.username!==e})):c.from===t.chatUser&&(t.messages.push(c),t.createContent(c.from,null,c.text))},h.onclose=function(){console.log("websocket已关闭")},h.onerror=function(){console.log("websocket发生了错误")}}}}},x=(n("bc8a"),n("6b0d")),m=n.n(x);const v=m()(f,[["render",g]]);t["default"]=v},bc8a:function(e,t,n){"use strict";n("6c21")}}]);
//# sourceMappingURL=chunk-a0abed14.4731924f.js.map